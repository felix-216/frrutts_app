{% extends 'admin/layout.html' %}

    {% block cards %}
        <!-- right hand side div -->
        <div class="col-md-10 col2 rounded">
            <!-- first row for the right hand side -->
            <div class="parentDiv1 rounded d-lg-flex mt-2 justify-content-between ">
                <div class="childDiv1 rounded shadow">
                    <p><i class="fas fa-shopping-bag ms-2"></i> TODAY'S SALES </p>
                    {% set total_sales = sales | sum(attribute='pay_amount') %}

                    <h2 class="heading1 ms-2">&#8358; {{total_sales}}</h2>
                </div>
                <div class="childDiv1 rounded shadow">
                    <p><i class="fas fa-dolly ms-2"></i>TODAY'S ORDERS</p>
                    <h2 class="heading1 ms-2">{{ todays_order|length }}</h2>
                </div>
                <div class="childDiv1 rounded shadow">
                    <p><i class="fas fa-users ms-2"></i> ACTIVE USERS</p>
                    <h2 class="heading1 ms-2">{{ users|length }}</h2>
                </div>
                <div class="childDiv1 rounded shadow">
                    <p><i class="fas fa-clock ms-2"></i>  AVAILABLE BOXES</p>

                    <h2 class="heading1 ms-2">{{ enabled_boxes|length }}</h2>
                </div>
        </div>
    {% endblock %}
    

    {% block table1 %}
        <!-- second row for the right hand side -->
        <div class="row rowCol rounded mt-4">
            <div class="col-12 nestedCol me-md-3 rounded table-responsive shadow">
                {% if todays_order %}
                    <table class="w-100">

                        <thead>
                            <tr>
                                <th colspan="1">Recent Orders</th>
                                
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th>Product</th>
                                <th>Customer</th>
                                <th>Payment Status</th>
                                <th>Action</th>
                                <th>Box size</th>
                            </tr>
                            {% for order in todays_order %}
                                <tr>
                                    <td>{{ order.box.box_name| title }} </td>
                                    <td>{{ order.user.user_fname| title }} {{ order.user.user_lname| title }}</td>

                                    {% if order.order_pay_status == 'pending' %}
                                        <td><p class="badge bg-danger">{{order.order_pay_status}}</p></td>
                                    {% elif order.order_pay_status == 'paid' %}
                                        <td><p class="badge bg-secondary">{{order.order_pay_status}}</p></td>
                                    {% endif %}

                                    
                                    <td> <a href="{{url_for('user_order', id=order.order_user_id)}}" class="btn btn-outline-warning btn-sm">View This User</a></td>


                                    {% if order.box.box_size == 'Small' %}
                                        <td><p class="badge bg-primary">{{order.box.box_size}}</p></td>
                                    {% elif order.box.box_size == 'Medium' %}
                                        <td><p class="badge bg-success">{{order.box.box_size}}</p></td>
                                    {% else %}
                                        <td><p class="badge bg-danger">{{order.box.box_size}}</p></td>
                                    {% endif %}

                                    
                                </tr>
                            {% endfor %}
                        </tbody>

                    </table>
                {% endif %}
            </div>
            
        </div>
    {% endblock %}