{% extends 'admin/layout.html' %}

    {% block cards %}
        <!-- right hand side div -->
        <div class="col-md-10 col2 rounded">
            <!-- first row for the right hand side -->
            <div class="parentDiv1 rounded d-lg-flex mt-2 justify-content-between ">
                <div class="childDiv1 rounded shadow">
                    <p><i class="fas fa-shopping-bag ms-2"></i> TODAY'S SALES </p>
                    {% set total_sales = sales | sum(attribute='pay_amount') %}

                    <h2 class="heading1 ms-2">&#8358; {{total_sales}}</h2>
                </div>
                <div class="childDiv1 rounded shadow">
                    <p><i class="fas fa-dolly ms-2"></i>TODAY'S ORDERS</p>
                    <h2 class="heading1 ms-2">{{ todays_order|length }}</h2>
                </div>
                <div class="childDiv1 rounded shadow">
                    <p><i class="fas fa-users ms-2"></i> ACTIVE USERS</p>
                    <h2 class="heading1 ms-2">{{ users|length }}</h2>
                </div>
                <div class="childDiv1 rounded shadow">
                    <p><i class="fas fa-clock ms-2"></i>  AVAILABLE BOXES</p>

                    <h2 class="heading1 ms-2">{{ enabled_boxes|length }}</h2>
                </div>
        </div>
    {% endblock %}

        {% block table1 %}
        <!-- second row for the right hand side -->
        <div class="row rowCol rounded mt-4 ">
            <div class="col-12 nestedCol me-md-3 rounded table-responsive shadow">
                {% if pay %}
                    <table class="w-100">

                        <thead>
                            <tr>
                                <th colspan="3">Payments</th>
                                <th colspan="2"><button class="btn btn-sm btn-primary">View All</button></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Amount</td>
                                <td>Customer Name</td>
                                <td>Payment status</td>
                                <td>Payment Time</td>
                                <td>Box size</td>
                            </tr>
                            {% for pay in pay %}
                            <tr>
                                <td>{{ pay.pay_amount }} </td>
                                <td>{{ pay.orders.user.user_fname | title}}</td>
                                
                                {% if pay.pay_status == 'pending' %}
                                    <td><p class="badge bg-warning rounded-1">{{ pay.pay_status }}</p></td>
                                {% elif pay.pay_status == 'failed' %}
                                    <td><p class="badge bg-danger rounded-1">{{ pay.pay_status }}</p></td>
                                {% else %}
                                    <td><p class="badge bg-success rounded-1">{{ pay.pay_status }}</p></td>
                                {% endif %}
                                <td>{{ pay.pay_createdat }}</td>
                                <td>{{ pay.orders.box.box_name }}</td>
                                
                            </tr>
                            {% endfor %}
                        </tbody>

                    </table>
                {% endif %}
            </div>
            
        </div>
    {% endblock %}