{% extends 'admin/layout.html' %}

    {% block cards %}
        <!-- right hand side div -->
        <div class="col-md-10 col2 rounded">
            <!-- first row for the right hand side -->
            <div class="parentDiv1 rounded d-lg-flex mt-2 justify-content-between ">
                <div class="childDiv1 rounded shadow">
                    <p><i class="fas fa-shopping-bag ms-2"></i> TODAY'S SALES </p>
                    {% set total_sales = sales | sum(attribute='pay_amount') %}

                    <h2 class="heading1 ms-2">&#8358; {{total_sales}}</h2>
                </div>
                <div class="childDiv1 rounded shadow">
                    <p><i class="fas fa-dolly ms-2"></i>TODAY'S ORDERS</p>
                    <h2 class="heading1 ms-2">{{ todays_order|length }}</h2>
                </div>
                <div class="childDiv1 rounded shadow">
                    <p><i class="fas fa-users ms-2"></i> ACTIVE USERS</p>
                    <h2 class="heading1 ms-2">{{ users|length }}</h2>
                </div>
                <div class="childDiv1 rounded shadow">
                    <p><i class="fas fa-clock ms-2"></i>  AVAILABLE BOXES</p>

                    <h2 class="heading1 ms-2">{{ enabled_boxes|length }}</h2>
                </div>
        </div>
    {% endblock %}

    {% block table1 %}
        <!-- second row for the right hand side -->
        <div class="row rowCol rounded mt-4">
            <div class="col-12 nestedCol me-md-3 rounded table-responsive">
                
                {% set messages = get_flashed_messages(with_categories=True) %}
				{% if messages %}
					{% for cat,msg in messages %}
						{% if cat == 'error' %}
							<p class="alert alert-danger">{{msg}}</p>
						{% else %}
							<p class="alert alert-success">{{msg}}</p>
						{% endif %}

					{% endfor %}
				{% endif %}
                
                <form action="" method="post" novalidate enctype="multipart/form-data">
                    <div>
                        {{ Update_box.csrf_token() }}
                        

                        {{ Update_box.boxname.label(class_="form-label") }}
                        {{ Update_box.boxname(placeholder="Enter Box Name",class_="form-control mb-3", value=box.box_name) }}
                        
                        {{ Update_box.boxsize.label(class_="form-label") }}
                        {{ Update_box.boxsize(placeholder="Enter Box Name",class_="form-select mb-3") }}

                        {{ Update_box.boxprice.label(class_="form-label") }}
                        {{ Update_box.boxprice(placeholder="Enter Box Price",class_="form-control mb-3", value=box.box_price ) }}

                        {{ Update_box.boximage.label(class_="form-label") }}
                        {{ Update_box.boximage(placeholder="Enter Box Image",class_="form-control mb-3") }}

                        {% for fruit in fruits %}
                            {% if fruit in fruit_and_box %}
                                <label class="mb-3">
                                    <input type="checkbox" name="fruit_ids" value="{{ fruit.fruit_id }}" checked>
                                    {{ fruit.fruit_name }}
                                </label><br>
                            {% else %}
                                <label class="mb-3">
                                    <input type="checkbox" name="fruit_ids" value="{{ fruit.fruit_id }}">
                                    {{ fruit.fruit_name }}
                                </label><br>
                            {% endif %}
                        {% endfor %}

                    </div>
                    <button class="btn btn-outline-success btn-lg">Add Fruit</button>
                </form>
            </div>
            
        </div>
    {% endblock %}